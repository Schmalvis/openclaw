#!/bin/bash
# scripts/install-addons.sh
# Install all custom add-ons (Homebrew + npm) for the Docker image.
# This script is called from the Dockerfile during build.
#
# ⚠️  IMPORTANT: Any new packages added here MUST ALSO be documented in ADDONS.md
# See ADDONS.md for the source of truth on what should be installed.
# DO NOT edit this file without updating ADDONS.md simultaneously.

set -e

echo "Installing custom add-ons..."

# ===== Homebrew Packages =====
echo "Installing Homebrew packages..."

# Google Workspace CLI (optional - may not be available in all environments)
echo "→ Installing gog (Google Workspace CLI)..."
if brew install steipete/tap/gogcli 2>&1; then
  echo "✓ gog installed successfully"
else
  echo "⚠️  gog installation skipped (may not be available in this build environment)"
fi

echo "✓ Homebrew packages processed."

# ===== NPM Global Packages =====
echo "Installing npm global packages..."

# Coinbase CDP SDK
echo "→ Installing @coinbase/cdp-sdk..."
if npm install -g @coinbase/cdp-sdk --no-audit --no-fund 2>&1; then
  echo "✓ @coinbase/cdp-sdk installed successfully"
else
  echo "❌ @coinbase/cdp-sdk installation failed"
  exit 1
fi

echo "✓ npm global packages installed."

echo "✅ All add-ons installed successfully."
